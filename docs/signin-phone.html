<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sign In</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="msapplication-config" content="none" />
  <style id="b2c-override" type="text/css">
    /* IMMEDIATE OVERRIDE - INJECTED BEFORE B2C */
    html, body { background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important; }
  </style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* CREATIVEAIGENT DESIGN TOKENS */
    :root {
      --b2c-primary: #6366f1;
      --b2c-primary-hover: #5855eb;
      --b2c-secondary: #8b5cf6;
      --b2c-accent: #3B82F6;
      --b2c-success: #10B981;
      --b2c-warning: #F59E0B;
      --b2c-error: #EF4444;
      --b2c-dark-bg: #0b0f1a;
      --b2c-mid-bg: #172A45;
      --b2c-light-bg: #303C55;
      --b2c-text-primary: #ffffff;
      --b2c-text-secondary: #B0C4DE;
      --b2c-text-muted: #9CA3AF;
      --b2c-border: rgba(255, 255, 255, 0.15);
      --b2c-border-focus: rgba(99, 102, 241, 0.5);
      --b2c-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      --b2c-shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.3);
    }

    /* NUCLEAR B2C OVERRIDE - FORCE DARK THEME */
    *, *::before, *::after {
      background: transparent !important;
      background-color: transparent !important;
    }
    
    /* FORCE EVERYTHING TO DARK GRADIENT */
    html, body, .ext-container, .ext-container-margin, .ext-container-padding,
    .ext-container .ext-container-margin, .ext-container .ext-container-padding,
    .ext-container .ext-container-margin .ext-container-padding,
    div, main, section, article, header, footer, nav, aside,
    [class*="ext-"], [id*="ext-"], [class*="container"], [id*="container"],
    .azure-b2c-container, .azure-b2c-card {
      background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important;
      background-color: #0b0f1a !important;
      background-attachment: fixed !important;
      background-image: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important;
    }
    
    /* TARGET B2C INJECTED CONTENT - CreativeAigent card */
    #api {
      background: rgba(10, 20, 60, 0.35) !important;
      backdrop-filter: blur(12px) !important;
      -webkit-backdrop-filter: blur(12px) !important;
      border: 1px solid var(--b2c-border) !important;
      border-radius: 18px !important;
      box-shadow: var(--b2c-shadow) !important;
      padding: 2rem !important;
      max-width: 400px !important;
      margin: 2rem auto !important;
    }
    
    /* B2C Form Elements */
    #api input[type="text"], #api input[type="tel"], #api input[type="email"], #api input[type="password"] {
      background: rgba(255, 255, 255, 0.05) !important;
      border: 1px solid var(--b2c-border) !important;
      border-radius: 12px !important;
      color: var(--b2c-text-primary) !important;
      padding: 12px 16px !important;
      font-size: 16px !important;
      width: 100% !important;
      box-sizing: border-box !important;
    }
    
    #api input[type="text"]:focus, #api input[type="tel"]:focus, #api input[type="email"]:focus, #api input[type="password"]:focus {
      outline: none !important;
      border: 2px solid var(--b2c-border-focus) !important;
      box-shadow: 0 0 0 3px rgba(99,102,241,0.1) !important;
    }
    
    /* B2C Buttons */
    #api button, #api input[type="submit"] {
      background: linear-gradient(135deg, var(--b2c-primary), var(--b2c-secondary)) !important;
      border: none !important;
      border-radius: 12px !important;
      color: white !important;
      padding: 14px 24px !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
    }
    
    #api button:hover, #api input[type="submit"]:hover {
      background: linear-gradient(135deg, var(--b2c-primary-hover), var(--b2c-primary)) !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4) !important;
    }
    
    /* B2C Text and Labels */
    #api label, #api p, #api div {
      color: var(--b2c-text-primary) !important;
      font-weight: 500 !important;
    }
    
    #api h1, #api h2, #api h3 {
      color: white !important;
      font-weight: 700 !important;
      text-align: center !important;
    }
    
    /* B2C Links */
    #api a {
      color: var(--b2c-accent) !important;
      text-decoration: none !important;
    }
    
    #api a:hover {
      color: var(--b2c-primary) !important;
      text-decoration: underline !important;
    }
    
    html, body {
      background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important;
      background-color: #0b0f1a !important;
    }
    
    .ext-container, .ext-container-margin, .ext-container-padding,
    .ext-container .ext-container-margin, .ext-container .ext-container-padding,
    .ext-container .ext-container-margin .ext-container-padding {
      background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important;
      background-color: #0b0f1a !important;
    }

    :root {
      --primary: #6366f1;
      --primary-dark: #5855eb;
      --primary-light: #8b5cf6;
      --secondary: #22c55e;
      --background: #111827;
      --surface: #1f2937;
      --text-primary: #f9fafb;
      --text-secondary: #d1d5db;
      --border: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.2);
    }

    body {
      background: linear-gradient(180deg, rgba(99,102,241,0.9) 0%, rgba(139,92,246,0.95) 100%) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      color: var(--text-primary) !important;
      margin: 0 !important;
      padding: 0 !important;
      min-height: 100vh !important;
    }

    /* COMPLETE B2C THEME OVERRIDE */
    
    /* Force page background */
    html, body {
      background: linear-gradient(180deg, rgba(99,102,241,0.9) 0%, rgba(139,92,246,0.95) 100%) !important;
      background-attachment: fixed !important;
      margin: 0 !important;
      padding: 0 !important;
      min-height: 100vh !important;
    }

    /* B2C Container Overrides */
    .ext-container, .ext-container-margin, .ext-container-padding,
    .ext-container .ext-container-margin, .ext-container .ext-container-padding,
    .ext-container .ext-container-margin .ext-container-padding {
      background: linear-gradient(180deg, rgba(99,102,241,0.9) 0%, rgba(139,92,246,0.95) 100%) !important;
      background-attachment: fixed !important;
      min-height: 100vh !important;
      padding: 0 !important;
      margin: 0 !important;
    }

    /* B2C Form Container */
    .ext-container .ext-container-margin .ext-container-padding {
      background: transparent !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      min-height: 100vh !important;
      padding: 20px !important;
    }

    /* B2C Form Card */
    .ext-container .ext-container-margin .ext-container-padding > div {
      background: rgba(17, 24, 39, 0.52) !important;
      backdrop-filter: saturate(160%) blur(16px) !important;
      border: 1px solid rgba(255, 255, 255, 0.08) !important;
      border-radius: 16px !important;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2) !important;
      padding: 2rem !important;
      max-width: 400px !important;
      width: 100% !important;
      margin: 0 auto !important;
    }

    .wrap { 
      max-width: 440px; 
      margin: 6vh auto; 
      padding: 0 16px; 
    }

    .card { 
      background: rgba(17, 24, 39, 0.3) !important;
      backdrop-filter: saturate(180%) blur(20px) !important;
      border: 1px solid rgba(255, 255, 255, 0.15) !important;
      border-radius: 16px !important;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3) !important;
      padding: 2rem !important;
    }

    h1 { 
      font-size: 1.5rem !important;
      margin: 0 0 2rem !important;
      text-align: center !important;
      color: var(--text-primary) !important;
      font-weight: 600 !important;
    }

    .hint { 
      color: var(--text-secondary) !important;
      font-size: 1rem !important;
      margin: 0 0 2rem !important;
      text-align: center !important;
    }

    #api { 
      margin-top: 8px; 
    }

    /* B2C Form Styling */
    .api {
      background: transparent !important;
    }

    /* B2C Form Elements */
    .ext-container h1, .ext-container h2, .ext-container h3, 
    .ext-container h4, .ext-container h5, .ext-container h6 {
      color: var(--text-primary) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      font-weight: 600 !important;
      text-align: center !important;
      margin-bottom: 1rem !important;
    }

    .ext-container h1 {
      font-size: 1.5rem !important;
      margin-bottom: 2rem !important;
    }

    .ext-container p, .ext-container div, .ext-container span {
      color: var(--text-secondary) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    /* B2C Input Fields */
    .ext-container input[type="text"], 
    .ext-container input[type="email"], 
    .ext-container input[type="password"],
    .ext-container input[type="tel"],
    .ext-container select {
      background: rgba(17, 24, 39, 0.52) !important;
      border: 1px solid rgba(255, 255, 255, 0.08) !important;
      border-radius: 12px !important;
      color: var(--text-primary) !important;
      font-size: 1rem !important;
      padding: 12px 16px !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      box-sizing: border-box !important;
      margin-bottom: 1rem !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    .ext-container input:focus, .ext-container select:focus {
      border-color: var(--primary) !important;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2) !important;
      outline: none !important;
    }

    .ext-container input::placeholder, .ext-container select::placeholder {
      color: var(--text-secondary) !important;
      opacity: 0.7 !important;
    }

    /* B2C Buttons */
    .ext-container button, .ext-container input[type="submit"], 
    .ext-container .primary-button {
      background: linear-gradient(135deg, var(--primary), var(--primary-light)) !important;
      border: none !important;
      border-radius: 12px !important;
      color: white !important;
      font-weight: 500 !important;
      padding: 12px 24px !important;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3) !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      font-size: 1rem !important;
      cursor: pointer !important;
      margin-top: 1rem !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    .ext-container button:hover, .ext-container input[type="submit"]:hover {
      background: linear-gradient(135deg, var(--primary-dark), var(--primary)) !important;
      box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4) !important;
      transform: translateY(-1px) !important;
    }

    /* B2C Links */
    .ext-container a {
      color: var(--primary) !important;
      text-decoration: none !important;
      transition: color 0.2s ease !important;
    }

    .ext-container a:hover {
      color: var(--primary-light) !important;
    }

    /* B2C Labels */
    .ext-container label {
      color: var(--text-primary) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      font-size: 0.9rem !important;
      margin-bottom: 0.5rem !important;
      display: block !important;
    }

    /* Checkbox styling */
    .ext-container input[type="checkbox"] {
      width: 18px !important;
      height: 18px !important;
      accent-color: var(--primary) !important;
      margin-right: 8px !important;
    }

    .ext-container .checkbox-container {
      display: flex !important;
      align-items: center !important;
      margin-bottom: 1rem !important;
      gap: 0.5rem !important;
    }

    .ext-container .checkbox-label {
      color: var(--text-secondary) !important;
      font-size: 0.9rem !important;
    }

    /* Force B2C to use our theme */
    html, body, div, span, applet, object, iframe,
    h1, h2, h3, h4, h5, h6, p, blockquote, pre,
    a, abbr, acronym, address, big, cite, code,
    del, dfn, em, img, ins, kbd, q, s, samp,
    small, strike, strong, sub, sup, tt, var,
    b, u, i, center,
    dl, dt, dd, ol, ul, li,
    fieldset, form, label, legend,
    table, caption, tbody, tfoot, thead, tr, th, td,
    article, aside, canvas, details, embed, 
    figure, figcaption, footer, header, hgroup, 
    menu, nav, output, ruby, section, summary,
    time, mark, audio, video {
      background: transparent !important;
    }

    /* Override B2C's default page styling */
    .ext-container, .ext-container-margin, .ext-container-padding,
    .ext-container .ext-container-margin, .ext-container .ext-container-padding {
      background: linear-gradient(180deg, rgba(17,24,39,0.85) 0%, rgba(17,24,39,0.95) 100%) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      color: var(--text-primary) !important;
      min-height: 100vh !important;
    }

    .card-container {
      background: rgba(17, 24, 39, 0.52) !important;
      backdrop-filter: saturate(160%) blur(16px) !important;
      border: 1px solid var(--border) !important;
      border-radius: 16px !important;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2) !important;
      padding: 2rem !important;
      margin: 2rem auto !important;
      max-width: 400px !important;
    }

    input[type="text"], 
    input[type="email"], 
    input[type="password"],
    input[type="tel"] {
      background: rgba(17, 24, 39, 0.52) !important;
      border: 1px solid var(--border) !important;
      border-radius: 12px !important;
      color: var(--text-primary) !important;
      font-size: 1rem !important;
      padding: 12px 16px !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      box-sizing: border-box !important;
      margin-bottom: 1rem !important;
    }

    input[type="text"]:focus, 
    input[type="email"]:focus, 
    input[type="password"]:focus,
    input[type="tel"]:focus {
      border-color: var(--primary) !important;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2) !important;
      outline: none !important;
    }

    input[type="text"]::placeholder, 
    input[type="email"]::placeholder, 
    input[type="password"]::placeholder,
    input[type="tel"]::placeholder {
      color: var(--text-secondary) !important;
      opacity: 0.7 !important;
    }

    select {
      background: rgba(17, 24, 39, 0.52) !important;
      border: 1px solid var(--border) !important;
      border-radius: 12px !important;
      color: var(--text-primary) !important;
      font-size: 1rem !important;
      padding: 12px 16px !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      box-sizing: border-box !important;
      margin-bottom: 1rem !important;
    }

    select:focus {
      border-color: var(--primary) !important;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2) !important;
      outline: none !important;
    }

    button[type="submit"], 
    .primary-button {
      background: linear-gradient(135deg, var(--primary), var(--primary-light)) !important;
      border: none !important;
      border-radius: 12px !important;
      color: white !important;
      font-weight: 500 !important;
      padding: 12px 24px !important;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3) !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      font-size: 1rem !important;
      cursor: pointer !important;
      margin-top: 1rem !important;
    }

    button[type="submit"]:hover, 
    .primary-button:hover {
      background: linear-gradient(135deg, var(--primary-dark), var(--primary)) !important;
      box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4) !important;
      transform: translateY(-1px) !important;
    }

    button[type="submit"]:active, 
    .primary-button:active {
      transform: translateY(0) !important;
    }

    .secondary-button, 
    .cancel-button {
      background: rgba(255, 255, 255, 0.1) !important;
      border: 1px solid var(--border) !important;
      border-radius: 12px !important;
      color: var(--text-primary) !important;
      padding: 12px 24px !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      font-size: 1rem !important;
      cursor: pointer !important;
      margin-top: 0.5rem !important;
    }

    .secondary-button:hover, 
    .cancel-button:hover {
      background: rgba(255, 255, 255, 0.2) !important;
      border-color: var(--border-hover) !important;
    }

    a {
      color: var(--primary) !important;
      text-decoration: none !important;
      transition: color 0.2s ease !important;
    }

    a:hover {
      color: var(--primary-light) !important;
    }

    .error-message {
      color: #ef4444 !important;
      background: rgba(239, 68, 68, 0.1) !important;
      border: 1px solid rgba(239, 68, 68, 0.2) !important;
      border-radius: 8px !important;
      padding: 12px !important;
      margin-bottom: 1rem !important;
      font-size: 0.9rem !important;
    }

    .success-message {
      color: var(--secondary) !important;
      background: rgba(34, 197, 94, 0.1) !important;
      border: 1px solid rgba(34, 197, 94, 0.2) !important;
      border-radius: 8px !important;
      padding: 12px !important;
      margin-bottom: 1rem !important;
      font-size: 0.9rem !important;
    }

    .divider {
      border-top: 1px solid var(--border) !important;
      margin: 1.5rem 0 !important;
    }

    .social-button {
      background: rgba(255, 255, 255, 0.05) !important;
      border: 1px solid var(--border) !important;
      border-radius: 12px !important;
      color: var(--text-primary) !important;
      padding: 12px 16px !important;
      transition: all 0.2s ease !important;
      width: 100% !important;
      margin-bottom: 0.5rem !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 0.5rem !important;
      cursor: pointer !important;
    }

    .social-button:hover {
      background: rgba(255, 255, 255, 0.1) !important;
      border-color: var(--border-hover) !important;
    }

    .checkbox-container {
      display: flex !important;
      align-items: center !important;
      margin-bottom: 1rem !important;
      gap: 0.5rem !important;
    }

    input[type="checkbox"] {
      width: 18px !important;
      height: 18px !important;
      accent-color: var(--primary) !important;
    }

    .checkbox-label {
      color: var(--text-secondary) !important;
      font-size: 0.9rem !important;
    }

    /* Creative Aigent Logo Styling */
    .logo-container {
      text-align: center !important;
      margin-bottom: 2rem !important;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 9999 !important;
    }

    .logo {
      display: inline-flex !important;
      align-items: center !important;
      gap: 12px !important;
      padding: 16px 24px !important;
      background: rgba(255, 255, 255, 0.05) !important;
      border: 1px solid rgba(255, 255, 255, 0.1) !important;
      border-radius: 12px !important;
      backdrop-filter: blur(10px) !important;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 9999 !important;
    }

    .logo-icon {
      width: 40px !important;
      height: 40px !important;
      object-fit: contain !important;
      border-radius: 8px !important;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 9999 !important;
    }

    .logo-text {
      font-size: 1.1rem !important;
      font-weight: 600 !important;
      color: var(--text-primary) !important;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    }

    /* Phone control specific styling */
    .phoneControl {
      display: flex !important;
      gap: 0.5rem !important;
      margin-bottom: 1rem !important;
    }

    .phoneControl select {
      flex: 0 0 auto !important;
      width: auto !important;
      min-width: 120px !important;
      margin-bottom: 0 !important;
    }

    .phoneControl input {
      flex: 1 !important;
      margin-bottom: 0 !important;
    }

    @media (max-width: 768px) {
      .card-container {
        padding: 1.5rem !important;
        margin: 1rem !important;
        max-width: calc(100% - 2rem) !important;
      }
      
      .card {
        padding: 1.5rem !important;
        margin: 1rem !important;
      }
      
      input[type="text"], 
      input[type="email"], 
      input[type="password"],
      input[type="tel"] {
        font-size: 1.1rem !important;
        padding: 16px !important;
      }
      
      button[type="submit"], 
      .primary-button {
        padding: 16px 24px !important;
        font-size: 1.1rem !important;
      }
      
      h1 {
        font-size: 1.3rem !important;
      }
    }
  </style>
</head>
<body style="background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important; background-color: #0b0f1a !important; margin: 0 !important; padding: 0 !important; min-height: 100vh !important;">
  <!-- Creative Aigent Logo - Outside API div as recommended by Microsoft -->
  <div class="logo-container" style="text-align: center !important; margin-bottom: 2rem !important; display: block !important; visibility: visible !important; opacity: 1 !important; z-index: 9999 !important;">
    <div class="logo" style="display: inline-flex !important; align-items: center !important; gap: 12px !important; padding: 16px 24px !important; background: rgba(255, 255, 255, 0.05) !important; border: 1px solid rgba(255, 255, 255, 0.1) !important; border-radius: 12px !important; backdrop-filter: blur(10px) !important; visibility: visible !important; opacity: 1 !important; z-index: 9999 !important;">
      <img src="https://creative-aigent.github.io/B2CAssets/icon-512.png" alt="Creative Aigent" class="logo-icon" style="width: 40px !important; height: 40px !important; object-fit: contain !important; border-radius: 8px !important; display: block !important; visibility: visible !important; opacity: 1 !important; z-index: 9999 !important;" />
      <div class="logo-text" style="font-size: 1.1rem !important; font-weight: 600 !important; color: #ffffff !important; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;">Creative Aigent</div>
    </div>
  </div>
  
  <!-- B2C Required API Container -->
  <div id="api" style="background: rgba(10, 20, 60, 0.35) !important; backdrop-filter: blur(12px) !important; -webkit-backdrop-filter: blur(12px) !important; border: 1px solid rgba(255, 255, 255, 0.15) !important; border-radius: 18px !important; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2) !important; padding: 2rem !important; max-width: 400px !important; margin: 2rem auto !important;"></div>

  <script>
    // --- 1) Favorites (order matters) - Enhanced based on Microsoft B2C patterns ---
    // Most commonly used countries for B2C applications
    const FAVORITES = [
      "US",  // United States (+1)
      "GB",  // United Kingdom (+44)  
      "CA",  // Canada (+1)
      "AU",  // Australia (+61)
      "DE",  // Germany (+49)
      "FR",  // France (+33)
      "IT",  // Italy (+39)
      "ES",  // Spain (+34)
      "NL",  // Netherlands (+31)
      "SE",  // Sweden (+46)
      "NO",  // Norway (+47)
      "DK",  // Denmark (+45)
      "CH",  // Switzerland (+41)
      "BE",  // Belgium (+32)
      "AT",  // Austria (+43)
      "IE",  // Ireland (+353)
      "SG",  // Singapore (+65)
      "HK",  // Hong Kong (+852)
      "JP",  // Japan (+81)
      "KR",  // South Korea (+82)
      "IN",  // India (+91)
      "ZA",  // South Africa (+27)
      "BR",  // Brazil (+55)
      "MX",  // Mexico (+52)
      "MA"   // Morocco (+212)
    ];

    // --- 2) Simple i18n (EN/FR) for the page chrome only ---
    function getLocale() {
      try {
        const qp = new URLSearchParams(window.location.search);
        const ui = (qp.get("ui_locales") || navigator.language || "en").toLowerCase();
        return ui.startsWith("fr") ? "fr" : "en";
      } catch (e) {
        return "en";
      }
    }
    
    function setTexts() {
      try {
        const t = { 
          en: { title: "Sign in with your phone number", sub: "Enter your phone number to continue" },
          fr: { title: "Connectez-vous avec votre numéro de téléphone", sub: "Saisissez votre numéro de téléphone pour continuer" }
        }[getLocale()];
        
        const titleEl = document.getElementById("title");
        const subtitleEl = document.getElementById("subtitle");
        
        if (titleEl) titleEl.textContent = t.title;
        if (subtitleEl) subtitleEl.textContent = t.sub;
      } catch (e) {
        console.warn("Error setting texts:", e);
      }
    }
    
    // Initialize texts when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', setTexts);
    } else {
      setTexts();
    }

    // --- 3) Pin favorite countries while keeping the rest ---
    function findCountrySelect() {
      try {
        // B2C uses a phone control with a country <select>. Try common selectors.
        const sels = [
          'select#country',
          'select[name*="country"]',
          'select[id*="country"]',
          '.phoneControl select',
          'select[aria-label*="Country"]',
          'select[aria-label*="Pays"]',
          'select'
        ];
        for (const s of sels) {
          const el = document.querySelector(s);
          if (el && el.tagName === "SELECT" && el.options?.length > 0) return el;
        }
        return null;
      } catch (e) {
        console.warn("Error finding country select:", e);
        return null;
      }
    }

    function pinFavorites(selectEl) {
      try {
        if (!selectEl || !selectEl.options) return;

        // Preserve current selection
        const current = selectEl.value;

        // Map options by value (B2C uses ISO codes as values in the country list)
        const all = Array.from(selectEl.options);
        const map = new Map(all.map(o => [String(o.value).toUpperCase(), o]));

        const favs = [];
        const rest = [];

        FAVORITES.forEach(code => {
          const opt = map.get(code.toUpperCase());
          if (opt) favs.push(opt);
        });

        all.forEach(o => {
          const code = String(o.value).toUpperCase();
          if (!FAVORITES.includes(code)) rest.push(o);
        });

        // Rebuild dropdown: favorites first, then the rest (original order preserved)
        selectEl.innerHTML = "";
        [...favs, ...rest].forEach(o => selectEl.appendChild(o));

        // Restore selection if any
        if (current) selectEl.value = current;
      } catch (e) {
        console.warn("Error pinning favorites:", e);
      }
    }

    // React to B2C injecting content
    function initializeObserver() {
      try {
        const api = document.getElementById("api");
        if (!api) {
          console.warn("API element not found, retrying...");
          setTimeout(initializeObserver, 1000);
          return;
        }

        const obs = new MutationObserver((mutations) => {
          try {
            let shouldRepin = false;
            mutations.forEach((mutation) => {
              if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                shouldRepin = true;
              }
            });
            
            if (shouldRepin) {
              // Use setTimeout to ensure B2C has finished rendering
              setTimeout(() => {
                const sel = findCountrySelect();
                if (sel) {
                  pinFavorites(sel);
                }
              }, 100);
            }
          } catch (e) {
            console.warn("Error in mutation observer:", e);
          }
        });
        
        // Start observing after a short delay to ensure B2C is ready
        setTimeout(() => {
          try {
            obs.observe(api, { childList: true, subtree: true });
          } catch (e) {
            console.warn("Error starting observer:", e);
          }
        }, 500);
      } catch (e) {
        console.warn("Error initializing observer:", e);
      }
    }

    // Force complete B2C theming - ULTRA AGGRESSIVE
    function forceB2CTheme() {
      try {
        // Inject CSS directly into the page
        const style = document.createElement('style');
        style.textContent = `
          * { background: transparent !important; background-color: transparent !important; }
          html, body, div, main, section, .ext-container, .ext-container-margin, .ext-container-padding { background: linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%) !important; background-color: #0b0f1a !important; background-attachment: fixed !important; }
          .ext-container .ext-container-margin .ext-container-padding > div { background: rgba(255, 255, 255, 0.1) !important; backdrop-filter: blur(20px) saturate(180%) !important; border: 1px solid rgba(255, 255, 255, 0.2) !important; border-radius: 20px !important; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1) !important; }
        `;
        document.head.appendChild(style);
        
        // MATCH YOUR MAIN APP BACKGROUND - Dark Blue Gradient
        const appGradient = 'linear-gradient(135deg, #0b0f1a 0%, #0f172a 40%, #0f1c33 100%)';
        document.body.style.setProperty('background', appGradient, 'important');
        document.body.style.setProperty('background-color', '#0b0f1a', 'important');
        document.body.style.setProperty('background-image', appGradient, 'important');
        document.documentElement.style.setProperty('background', appGradient, 'important');
        document.documentElement.style.setProperty('background-color', '#0b0f1a', 'important');
        document.documentElement.style.setProperty('background-image', appGradient, 'important');
        
        // Target B2C API injected content specifically - Beautiful Glassmorphic Design
        const apiContainer = document.getElementById('api');
        if (apiContainer) {
          // Style the API container with glassmorphic effect
          apiContainer.style.setProperty('background', 'rgba(255, 255, 255, 0.1)', 'important');
          apiContainer.style.setProperty('backdrop-filter', 'blur(20px) saturate(180%)', 'important');
          apiContainer.style.setProperty('border', '1px solid rgba(255, 255, 255, 0.2)', 'important');
          apiContainer.style.setProperty('border-radius', '20px', 'important');
          apiContainer.style.setProperty('box-shadow', '0 8px 32px rgba(0, 0, 0, 0.1)', 'important');
          apiContainer.style.setProperty('padding', '2rem', 'important');
          apiContainer.style.setProperty('max-width', '400px', 'important');
          apiContainer.style.setProperty('margin', '2rem auto', 'important');
          
          // Style form inputs
          const inputs = apiContainer.querySelectorAll('input[type="text"], input[type="tel"], input[type="email"], input[type="password"]');
          inputs.forEach(input => {
            input.style.setProperty('background', 'rgba(255, 255, 255, 0.9)', 'important');
            input.style.setProperty('border', '1px solid rgba(255, 255, 255, 0.3)', 'important');
            input.style.setProperty('border-radius', '12px', 'important');
            input.style.setProperty('color', '#1f2937', 'important');
            input.style.setProperty('padding', '12px 16px', 'important');
            input.style.setProperty('font-size', '16px', 'important');
          });
          
          // Style buttons
          const buttons = apiContainer.querySelectorAll('button, input[type="submit"]');
          buttons.forEach(button => {
            button.style.setProperty('background', 'linear-gradient(135deg, #8b5cf6, #a855f7)', 'important');
            button.style.setProperty('border', 'none', 'important');
            button.style.setProperty('border-radius', '12px', 'important');
            button.style.setProperty('color', 'white', 'important');
            button.style.setProperty('padding', '14px 24px', 'important');
            button.style.setProperty('font-weight', '600', 'important');
          });
          
          // Style text elements
          const textElements = apiContainer.querySelectorAll('label, p, div, h1, h2, h3');
          textElements.forEach(el => {
            if (!el.querySelector('input') && !el.querySelector('button')) {
              el.style.setProperty('color', 'white', 'important');
            }
          });
          
          // Style links
          const links = apiContainer.querySelectorAll('a');
          links.forEach(link => {
            link.style.setProperty('color', '#c4b5fd', 'important');
          });
        }
        
        // Force ALL elements to have app background
        const allElements = document.querySelectorAll('*');
        allElements.forEach(el => {
          if (el.tagName.toLowerCase() !== 'img' && el.id !== 'api') {
            el.style.setProperty('background', appGradient, 'important');
            el.style.setProperty('background-color', '#0b0f1a', 'important');
          }
        });
        
        // Force B2C containers
        const b2cContainers = document.querySelectorAll('.ext-container, .ext-container-margin, .ext-container-padding');
        b2cContainers.forEach(container => {
          container.style.background = appGradient;
          container.style.minHeight = '100vh';
          container.style.padding = '0';
          container.style.margin = '0';
        });

        // Force form card styling - Enhanced glassmorphic effect
        const formCards = document.querySelectorAll('.ext-container .ext-container-margin .ext-container-padding > div');
        formCards.forEach(card => {
          card.style.background = 'rgba(99,102,241,0.15)';
          card.style.backdropFilter = 'saturate(180%) blur(20px)';
          card.style.border = '1px solid rgba(255, 255, 255, 0.2)';
          card.style.boxShadow = '0 8px 32px rgba(99,102,241,0.2)';
        });

        // Force logo visibility
        const logoIcon = document.querySelector('.logo-icon');
        if (logoIcon) {
          logoIcon.style.display = 'block';
          logoIcon.style.visibility = 'visible';
          logoIcon.style.opacity = '1';
          logoIcon.style.zIndex = '9999';
        }
        
        const logoContainer = document.querySelector('.logo-container');
        if (logoContainer) {
          logoContainer.style.display = 'block';
          logoContainer.style.visibility = 'visible';
          logoContainer.style.opacity = '1';
          logoContainer.style.zIndex = '9999';
        }
          card.style.borderRadius = '16px';
          card.style.boxShadow = '0 4px 16px rgba(0,0,0,0.2)';
          card.style.padding = '2rem';
          card.style.maxWidth = '400px';
          card.style.width = '100%';
          card.style.margin = '0 auto';
        });

        // Force input styling
        const inputs = document.querySelectorAll('.ext-container input, .ext-container select');
        inputs.forEach(input => {
          input.style.background = 'rgba(17, 24, 39, 0.52)';
          input.style.border = '1px solid rgba(255, 255, 255, 0.08)';
          input.style.borderRadius = '12px';
          input.style.color = '#f9fafb';
          input.style.padding = '12px 16px';
          input.style.fontFamily = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';
        });

        // Force button styling
        const buttons = document.querySelectorAll('.ext-container button, .ext-container input[type="submit"]');
        buttons.forEach(button => {
          button.style.background = 'linear-gradient(135deg, #6366f1, #8b5cf6)';
          button.style.border = 'none';
          button.style.borderRadius = '12px';
          button.style.color = 'white';
          button.style.padding = '12px 24px';
          button.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.3)';
          button.style.fontFamily = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';
        });

        // Force text styling
        const headings = document.querySelectorAll('.ext-container h1, .ext-container h2, .ext-container h3');
        headings.forEach(heading => {
          heading.style.color = '#f9fafb';
          heading.style.fontFamily = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';
          heading.style.fontWeight = '600';
          heading.style.textAlign = 'center';
        });

        const paragraphs = document.querySelectorAll('.ext-container p, .ext-container div, .ext-container span');
        paragraphs.forEach(p => {
          p.style.color = '#d1d5db';
          p.style.fontFamily = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';
        });

        // Remove any white backgrounds
        const allElements = document.querySelectorAll('*');
        allElements.forEach(el => {
          if (el.style.backgroundColor === 'white' || el.style.backgroundColor === '#ffffff' || el.style.backgroundColor === 'rgb(255, 255, 255)') {
            el.style.backgroundColor = 'transparent';
          }
        });

      } catch (e) {
        console.warn("Error forcing B2C theme:", e);
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        initializeObserver();
        forceB2CTheme();
      });
    } else {
      initializeObserver();
      forceB2CTheme();
    }

        // Force B2C theme periodically to override B2C - NUCLEAR FREQUENCY
        setInterval(forceB2CTheme, 10);
    
    // Also force on window load
    window.addEventListener('load', forceB2CTheme);
    
    // Force immediately
    forceB2CTheme();

    // Re-pin on language change (B2C can re-render)
    window.addEventListener("hashchange", () => {
      try {
        setTimeout(() => {
          const sel = findCountrySelect();
          if (sel) pinFavorites(sel);
        }, 100);
      } catch (e) {
        console.warn("Error handling hashchange:", e);
      }
    });
  </script>
</body>
</html>
